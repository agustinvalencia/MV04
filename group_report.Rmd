---
title: "Assignment 4 - Canonical Correlation Analysis"
author: |
  | **GROUP 03**
  | Agustin Valencia - **aguva779**
  | Bayu Brahmantio  - **baybr878**
  | Joris van Doorn - **jorva845**
  | Marcos F Mourao - **marfr825**
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  pdf_document: default
---

```{r setup, include=FALSE}
RNGversion('3.5.1')
knitr::opts_chunk$set(echo = TRUE)
library(expm)
```

```{r, echo=FALSE}
data <- read.table("./Data/P10-16.DAT")
```

# Canonical correlation analysis by utilizing suit able software

Look at the data described in Exercise 10.16 of Johnson, Wichern. You may find it in the file P10-16.DAT. The data for 46 patients are summarized in a covariance matrix, which will be analyzed in R. Read through the description of the different R packages and functions so you may chose the must suitable one for the analysis. Supplement with own code where necessary.

```{r}
#number of observations (patients)
n <- 46
#number of primary variables
p <- 3
#number of secondary variables
q <- 2
#separating the variance-covariance matrix
sigma11 <- as.matrix(data[1:3,1:3])
sigma22 <- as.matrix(data[4:5, 4:5])
sigma21 <- as.matrix(data[4:5, 1:3])
sigma12 <- as.matrix(data[1:3, 4:5])

#get eigenvectors
e <- sqrtm(sigma11) %*% sigma12 %*% solve(sigma22) %*% sigma21 %*% sqrtm(sigma11)

f <- sqrtm(sigma22) %*% sigma21 %*% solve(sigma11) %*% sigma12 %*% sqrtm(sigma22)

#get eigenvalues

```


a) Test at the 5% level if there is any association between the groups of variables.

```{r}
alpha <- 0.05
#critical value
crit <- qchisq(p = (1-alpha), df = p*q)
#test statistic

```


b) How many pairs of canonical variates are significant?

c) Interpret the "significant" squared canonical correlations.
Tip: Read section "Canonical Correlations as Generalizations of Other Correlation Coefficients".

d) Interpret the canonical variates by using the coefficients and suitable correlations.

e) Are the "significant" canonical variates good summary measures of the respective data sets?
Tip: Read section "Proportions of Explained Sample Variance".

f) Give your opinion on the success of this canonical correlation analysis.

# Appendix

```{r, ref.label=knitr::all_labels(),echo=TRUE,eval=FALSE,results='show'}
```
